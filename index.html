<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Final Embedded Player</title>
<style>
  body { margin: 0; background: #000; display: flex; justify-content: center; align-items: center; height: 100vh; }
  #player-wrapper { position: relative; width: 100%; max-width: 960px; height: 540px; background: #000; }
  iframe { width: 100%; height: 100%; border: none; }
  #controls {
    position: absolute; bottom: 10px; left: 10px; right: 10px; display: flex; justify-content: space-between; align-items: center;
    background: rgba(0,0,0,0.5); padding: 5px 10px; border-radius: 6px; font-family: sans-serif;
  }
  #controls button, #controls input[type=range] { cursor: pointer; }
  #controls button { background: rgba(255,255,255,0.2); border: none; color: #fff; padding: 5px 10px; border-radius: 4px; }
  #controls input[type=range] { flex: 1; margin: 0 10px; }
</style>
</head>
<body>

<div id="player-wrapper">
  <!-- iframe without sandbox -->
  <iframe id="videoPlayer" src="" allowfullscreen allow="autoplay; fullscreen"></iframe>

  <div id="controls">
    <button id="playBtn">Play</button>
    <input type="range" id="volume" min="0" max="1" step="0.05" value="1">
    <button id="fullscreenBtn">Fullscreen</button>
  </div>
</div>

<script>
  const params = new URLSearchParams(window.location.search);
  const videoId = params.get('id') || 'star1hi';
  const baseURL = "https://stream.crichd.sc/update/";

  const iframe = document.getElementById('videoPlayer');
  iframe.src = `${baseURL}${videoId}.php`;

  const playBtn = document.getElementById('playBtn');
  const volumeControl = document.getElementById('volume');
  const fullscreenBtn = document.getElementById('fullscreenBtn');

  // PostMessage commands for iframe control
  function sendCommand(cmd) {
    iframe.contentWindow.postMessage({ command: cmd }, '*');
  }

  // Play/Pause
  playBtn.addEventListener('click', () => {
    sendCommand('togglePlay');
  });

  // Volume control
  volumeControl.addEventListener('input', () => {
    sendCommand({ command: 'setVolume', value: volumeControl.value });
  });

  // Fullscreen
  fullscreenBtn.addEventListener('click', () => {
    const wrapper = document.getElementById('player-wrapper');
    if (wrapper.requestFullscreen) wrapper.requestFullscreen();
    else if (wrapper.webkitRequestFullscreen) wrapper.webkitRequestFullscreen();
    else if (wrapper.msRequestFullscreen) wrapper.msRequestFullscreen();
  });

  // Prevent iframe redirect
  window.addEventListener('message', e => {
    if (e.data === 'redirect') console.log('Blocked redirect attempt from iframe');
  });
</script>

</body>
</html>
